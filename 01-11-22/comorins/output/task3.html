<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
</head>
<body>
    <form>
        <label>Name</label>
        <input onkeyup="addDetails('name',this.value)"/><br><br>
        <label>Email</label>
        <input onkeyup="addDetails('email',this.value)"/><br><br>
        <label>Phone</label>
        <input  onkeyup="addDetails('phone',this.value)"/><br><br>
        <label>Role</label>
        <input  onkeyup="addDetails('role',this.value)"/><br><br>
        <label>Objective</label>
        <input placeholder="text your objective" onkeyup="addDetails('objective',this.value)"/><br><br>
        <label>Skills</label>
        <input onkeyup="addDetails('skills',this.value,0)"/>
        <input onkeyup="addDetails('skills',this.value,1)"/>
        <input onkeyup="addDetails('skills',this.value,2)"/>
        <input onkeyup="addDetails('skills',this.value,3)"/>
        <input onkeyup="addDetails('skills',this.value,4)"/><br><br>
        <table>
            <label>Education</label>
            <tr>
                <th>Course</th>
                <th>year</th>
                <th>Institute</th>
                <th>Percentage</th>
            </tr>
        <tr>
            <td><input onkeyup="addDetails('education',this.value,0,'course')"/></td>
            <td><input onkeyup="addDetails('education',this.value,0,'year')"/></td>
            <td><input onkeyup="addDetails('education',this.value,0,'institute')"/></td>
            <td><input onkeyup="addDetails('education',this.value,0,'percentage')"/></td>
        </tr>
        <tr>
            <td><input onkeyup="addDetails('education',this.value,1,'course')"/></td>
            <td><input onkeyup="addDetails('education',this.value,1,'year')"/></td>
            <td><input onkeyup="addDetails('education',this.value,1,'institute')"/></td>
            <td><input onkeyup="addDetails('education',this.value,1,'percentage')"/></td>
        </tr>
        <tr>
            <td><input onkeyup="addDetails('education',this.value,2,'course')"/></td>
            <td><input onkeyup="addDetails('education',this.value,2,'year')"/></td>
            <td><input onkeyup="addDetails('education',this.value,2,'institute')"/></td>
            <td><input onkeyup="addDetails('education',this.value,2,'percentage')"/></td>
        </tr>
        <tr>
            <td><input onkeyup="addDetails('education',this.value,3,'course')"/></td>
            <td><input onkeyup="addDetails('education',this.value,3,'year')"/></td>
            <td><input onkeyup="addDetails('education',this.value,3,'institute')"/></td>
            <td><input onkeyup="addDetails('education',this.value,3,'percentage')"/></td>
        </tr>
        </table>
        <table>
            <label>Certification</label>
            <tr>
                <th>Course name</th>
                <th>Duration</th>
                <th>Institute</th>
            </tr>
        <tr>
            <td><input onkeyup="addDetails('certification',this.value,0,'coursename')"/></td>
            <td><input onkeyup="addDetails('certification',this.value,0,'duration')"/></td>
            <td><input onkeyup="addDetails('certification',this.value,0,'institute')"/></td>
        </tr>
        <tr>
            <td><input onkeyup="addDetails('certification',this.value,1,'coursename')"/></td>
            <td><input onkeyup="addDetails('certification',this.value,1,'duration')"/></td>
            <td><input onkeyup="addDetails('certification',this.value,1,'institute')"/></td>
        </tr>
        <tr>
            <td><input onkeyup="addDetails('certification',this.value,2,'coursename')"/></td>
            <td><input onkeyup="addDetails('certification',this.value,2,'duration')"/></td>
            <td><input onkeyup="addDetails('certification',this.value,2,'institute')"/></td>
        </tr>
        </table>
        <table>
            <label>Projects</label>
            <tr>
                <th>Title</th>
                <th>Abstract</th>
                <th>Year</th>
            </tr>
        <tr>
            <td><input onkeyup="addDetails('projects',this.value,0,'title')"/></td>
            <td><input onkeyup="addDetails('projects',this.value,0,'abstract')"/></td>
            <td><input onkeyup="addDetails('projects',this.value,0,'year')"/></td>
        </tr>
        <tr>
            <td><input onkeyup="addDetails('projects',this.value,1,'title')"/></td>
            <td><input onkeyup="addDetails('projects',this.value,1,'abstract')"/></td>
            <td><input onkeyup="addDetails('projects',this.value,1,'year')"/></td>
        </tr>
        </table>
        <h2>Personal details</h2>
    <label>Address</label>
    <textarea onkeyup="addDetails('Personal_details',this.value,'Address')"></textarea><br><br>
    <label>Father Name</label>
    <input onkeyup="addDetails('Personal_details',this.value,'fathername')"/><br><br>
    <label>Mother Name</label>
    <input onkeyup="addDetails('Personal_details',this.value,'mothername')"/><br><br>
    <label>Marrital Status</label>
    <input onkeyup="addDetails('Personal_details',this.value,'Marrital_Status')"/><br><br>
    <label>Date of Birth</label>
    <input type="date" onkeyup="addDetails('Personal_details',this.value,'DOB')"/><br><br>
    <label>Gender</label>
    <input onkeyup="addDetails('Personal_details',this.value,'Gender')"/><br><br>
    <label>language known</label>
    <input onkeyup="addDetails('language_known',this.value,0)"/>
    <input onkeyup="addDetails('language_known',this.value,1)"/>
    <input onkeyup="addDetails('language_known',this.value,2)"/>
    <input onkeyup="addDetails('language_known',this.value,3)"/>
    <input onkeyup="addDetails('language_known',this.value,4)"/>
    <br><br>
    <label>Hobbies</label>
    <input onkeyup="addDetails('Hobbies',this.value,0)"/>
    <input onkeyup="addDetails('Hobbies',this.value,1)"/>
    <input onkeyup="addDetails('Hobbies',this.value,2)"/>
    <input onkeyup="addDetails('Hobbies',this.value,3)"/>
    <input onkeyup="addDetails('Hobbies',this.value,4)"/>
    <input onkeyup="addDetails('Hobbies',this.value,5)"/>
    <input onkeyup="addDetails('Hobbies',this.value,6)"/><br><br>
    <label>Declaration</label>
    <input placeholder="text declaration here" onkeyup="addDetails('declaration',this.value)"/><br><br>    
       
</form>
<button id="submitbutton">submit</button> 
<!--<button id="getbutton">Get</button> 
<button id="deletebutton">Delete</button>-->
<button id="getresume" >Get Resume</button> <br><br>

<table class="table">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Name</th>
        <th scope="col">Phone number</th>
        <th scope="col">Role</th>
        <th scope="col">Action</th>
        <th scope="col">View</th>
      </tr>
    </thead>
    <tbody id="table">

    </tbody>

</table>

    <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.1.js"></script>
    <script type="text/javascript">
         let obj_datas={
            skills:[],
            education:[{}],
            certification:[{}],
            projects:[{}],
            Personal_details:{},
            language_known:[],
            Hobbies:[]
        }
        function addDetails(key,value,index=null,indexkey=null) {
           if(index==null && indexkey==null) {
                obj_datas[key]=value;
            }else if(indexkey==null){
                obj_datas[key][index]=value;
            }
            else{
                if(!obj_datas[key][index]){
                    obj_datas[key][index]={}
                }
                obj_datas[key][index][indexkey]=value;
            }
            
        }
       
        $(document).ready(function () {
            $("#submitbutton").click(function () {
                $.ajax({
                    type:"post",
                    url:"http://karka.academy/api/action.php",
                    data:{
                        request:"create_resume",
                        user:"nithya",
                        resume:obj_datas
                    },
                    success: function (response) {
                        let details=JSON.parse(response).data;
                        console.log(details);
                        $("#table").html(``)
                        for (let i = 0; i < details.length; i++) {
                            let value = JSON.parse(details[i].data)
                            let element = `<tr><td>${i}</td>
                                <td>${value.name}</td>
                                <td>${value.phone}</td>
                                <td>${value.role}</td>
                                <td><button class='delete' value="${details[i].id}">Delete</button></td>
                                <td><a href='view.html?id=${details[i].id}'><button class='viewresume' value="${details[i].id}">View</button></a></td></tr>`;
                             $("#table").append(element); 
                            
                        }
                    }
                });
            });
            $.ajax({
                type:"get",
                url:"http://karka.academy/api/action.php",
                data:{
                    request:"get_user_resume",
                    user:"nithya",
                },
                success: function (response) {
                    let details=JSON.parse(response).data;
                    console.log(details);
    
                    for (let i = 0; i < details.length; i++) {
                        let value = JSON.parse(details[i].data)
                        let element = `<tr><td>${i}</td>
                            <td>${value.name}</td>
                            <td>${value.phone}</td>
                            <td>${value.role}</td>
                            <td><button class='delete' value="${details[i].id}">Delete</button></td>
                            <td><a href='view.html?id=${details[i].id}'><button class='viewresume' value="${details[i].id}">View</button></a></td></tr>`;
                        $("#table").append(element)
                            
                    }
                        
                },
            });
            $("#getresume").click(function () {
                let id_value=$(this).val()
                $.ajax({
                    type:"get",
                    url:"http://karka.academy/api/action.php",
                    data:{
                        request:"get_resume_by_id",
                        user:"nithya",
                        id:id_value
                    },
                    success: function (response) {
                        console.log(response);
                    }
                });
            });
        });
        $(document).on("click",".delete",function () {
            let id_value=$(this).val()
            $.ajax({
                    type:"get",
                    url:"http://karka.academy/api/action.php",
                    data:{
                        request:"delete_user_resume",
                        user:"nithya",
                        id:id_value
                    },
                    success: function (response) {
                        let details=JSON.parse(response).data;
                        console.log(details);
                        $("#table").html(``)
                        for (let i = 0; i < details.length; i++) {
                            let value = JSON.parse(details[i].data)
                            let element = `<tr><td>${i}</td>
                                <td>${value.name}</td>
                                <td>${value.phone}</td><td>${value.role}</td>
                                <td><button class='delete' value='${details[i].id}'>Delete</button></td>
                                <td><a href='view.html?id=${details[i].id}'><button class='viewresume' value="${details[i].id}">View</button></a></td></tr>`;
                             $("#table").append(element); 
                            
                        }
                    }
                });
        });
        $(document).on("click",".viewresume",function () {
            let id_value=$(this).val()
            $.ajax({
                    type:"get",
                    url:"http://karka.academy/api/action.php",
                    data:{
                        request:"delete_user_resume",
                        user:"nithya",
                        id:id_value
                    },
                    success: function (response) {
                        let details=JSON.parse(response).data;
                        console.log(details);
                        $("#table").html(``)
                        for (let i = 0; i < details.length; i++) {
                            let value = JSON.parse(details[i].data)
                            let element = `<tr><td>${i}</td>
                                <td>${value.name}</td>
                                <td>${value.phone}</td><td>${value.role}</td>
                                <td><button class='delete' value='${details[i].id}'>Delete</button></td>
                                <td><a href='view.html?id=${details[i].id}'><button class='viewresume' value="${details[i].id}">View</button></a></td></tr>`;
                             $("#table").append(element); 
                            
                        }
                    }
                });
        });
        
          // $("#getbutton").click(function () {
                // $.ajax({
                //     type:"get",
                //     url:"http://karka.academy/api/action.php",
                //     data:{
                //         request:"get_user_resume",
                //         user:"nithya",
            
                //     },
                //     success: function (response) {
                //         let details=JSON.parse(response).data;
                //         console.log(details);
                //         for (let i = 0; i < details.length; i++) {
                //             let value = JSON.parse(details[i].data)
                //             let element="<tr><td>"+i+"</td><td>"+value.name+"</td><td>"+value.phone+"</td><td>"+value.role+"</td><td><button class='delete'>Delete</button></td></tr>";
                //             $("#table").append(element);
                            
                //         }
                        
                //     },
                // });
            // });
            // $("#deletebutton").click(function () {
            //     $.ajax({
            //         type:"get",
            //         url:"http://karka.academy/api/action.php",
            //         data:{
            //             request:"delete_user_resume",
            //             user:"nithya",
            //             id:"868"
            //         },
            //         success: function (response) {
            //             console.log(response);
            //         }
            //     });
            // });
    </script>
</body>
</html>